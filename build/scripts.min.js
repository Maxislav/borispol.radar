function Timer(){this.time=null,this.init=function(){document.getElementById("hh").innerHTML=timer.checkNull((new Date).getHours())+":",document.getElementById("mi").innerHTML=timer.checkNull((new Date).getMinutes())+":",document.getElementById("ss").innerHTML=timer.checkNull((new Date).getSeconds()),setTimeout(function(){timer.init()},500)},this.checkNull=function(val){return 10>val?"0"+val:val}}function Main(){this.img=null,this.nN=null,this.eR=null,this.arrSrc=null,this.count=null,this.time=null,this.tmp=null,this.percent=null,this.blockedPlay=null,this.blockedScan=!1,this.arrImgUkbb=[],this.update=function(){},this.init=function(){var scope=this;if(!scope.blockedScan){scope.blockedScan=!0,$("#buttonScan").removeClass("button").addClass("button-blocked"),scope.blockedPlay=!0,$("#buttonPlay").removeClass("button").addClass("button-blocked"),scope.tmp="",this.time=((new Date).getTime()+"").split("");for(var i=0;10>i;i++)scope.tmp=scope.tmp+scope.time[i];scope.time=parseFloat(scope.tmp)-800,scope.nN=0,document.getElementById("scan").innerHTML=scope.nN,this.img=[],this.nN=0,this.eR=0,this.arrSrc=[],this.percent=0,this.loadImg()}},this.loadImg=function(){var scope=this;scope.img[scope.nN]=new Image,scope.img[scope.nN].onload=function(){scope.arrSrc[scope.nN]="http://meteoinfo.by/radar/UKBB/UKBB_"+(scope.time+scope.eR)+".png",scope.arrImgUkbb[scope.nN]=new Image,scope.arrImgUkbb[scope.nN].src=scope.arrSrc[scope.nN];var el=$(".home .ukbb-content .imgs");el.append($(scope.arrImgUkbb[scope.nN])),$(scope.arrImgUkbb[scope.nN]).fadeTo(222,1),scope.nN++,document.getElementById("scan").innerHTML=scope.nN,scope.eR=scope.eR-550,scope.nN<5?scope.loadImg():(scope.blockedScan=!1,$("#buttonScan").removeClass("button-blocked").addClass("button"),scope.blockedPlay=!1,$("#buttonPlay").removeClass("button-blocked").addClass("button"),document.getElementById("scanProcess").innerHTML="100%",scope.initPlay(scope.arrSrc.length-1))},scope.img[scope.nN].onerror=function(){scope.percent++,document.getElementById("scanProcess").innerHTML=(scope.percent/10+"").split(".")[1]?scope.percent/10+"%":scope.percent/10+".0%",100<scope.percent/10&&0==scope.nN?alert("Вероятно радар отключен"):(scope.eR--,scope.loadImg())},scope.img[scope.nN].src="http://meteoinfo.by/radar/UKBB/UKBB_"+(scope.time+scope.eR)+".png"},this.initPlay=function(){function play(k){k>=0?$(s.arrImgUkbb[k]).fadeTo(222,0,function(){setTimeout(function(){play(k-1)},500)}):(s.blockedPlay=!1,$("#buttonPlay").removeClass("button-blocked").addClass("button"))}var s=this;$("#buttonPlay").removeClass("button").addClass("button-blocked");for(var l=s.arrImgUkbb.length,m=0,i=0;l>i;i++)$(s.arrImgUkbb[i]).fadeTo(222,1,function(){m++,m==l&&setTimeout(function(){play(l-1)},1e3)})}}var timer=new Timer,main=new Main,DateFormat={};!function($){var daysInWeek=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDaysInWeek=["Вос","Пон","Втр","Срд","Чет","Пят","Суб"],shortMonthsInYear=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longMonthsInYear=["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonthsToNumber={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"},YYYYMMDD_MATCHER=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?\d{0,3}[Z\-+]?(\d{2}:?\d{2})?/;$.format=function(){function numberToLongDay(value){return daysInWeek[parseInt(value,10)]||value}function numberToShortDay(value){return shortDaysInWeek[parseInt(value,10)]||value}function numberToShortMonth(value){var monthArrayIndex=parseInt(value,10)-1;return shortMonthsInYear[monthArrayIndex]||value}function numberToLongMonth(value){var monthArrayIndex=parseInt(value,10)-1;return longMonthsInYear[monthArrayIndex]||value}function shortMonthToNumber(value){return shortMonthsToNumber[value]||value}function parseTime(value){var hour,minute,second,delimited,timeArray,time=value,millis="";return-1!==time.indexOf(".")&&(delimited=time.split("."),time=delimited[0],millis=delimited[1]),timeArray=time.split(":"),3===timeArray.length?(hour=timeArray[0],minute=timeArray[1],second=timeArray[2].replace(/\s.+/,"").replace(/[a-z]/gi,""),time=time.replace(/\s.+/,"").replace(/[a-z]/gi,""),{time:time,hour:hour,minute:minute,second:second,millis:millis}):{time:"",hour:"",minute:"",second:"",millis:""}}function padding(value,length){for(var paddingCount=length-String(value).length,i=0;paddingCount>i;i++)value="0"+value;return value}return{parseDate:function(value){var parsedDate={date:null,year:null,month:null,dayOfMonth:null,dayOfWeek:null,time:null};if("number"==typeof value)return this.parseDate(new Date(value));if("function"==typeof value.getFullYear)parsedDate.year=String(value.getFullYear()),parsedDate.month=String(value.getMonth()+1),parsedDate.dayOfMonth=String(value.getDate()),parsedDate.time=parseTime(value.toTimeString());else if(-1!=value.search(YYYYMMDD_MATCHER))values=value.split(/[T\+-]/),parsedDate.year=values[0],parsedDate.month=values[1],parsedDate.dayOfMonth=values[2],parsedDate.time=parseTime(values[3].split(".")[0]);else switch(values=value.split(" "),6===values.length&&isNaN(values[5])&&(values[values.length]="()"),values.length){case 6:parsedDate.year=values[5],parsedDate.month=shortMonthToNumber(values[1]),parsedDate.dayOfMonth=values[2],parsedDate.time=parseTime(values[3]);break;case 2:subValues=values[0].split("-"),parsedDate.year=subValues[0],parsedDate.month=subValues[1],parsedDate.dayOfMonth=subValues[2],parsedDate.time=parseTime(values[1]);break;case 7:case 9:case 10:parsedDate.year=values[3],parsedDate.month=shortMonthToNumber(values[1]),parsedDate.dayOfMonth=values[2],parsedDate.time=parseTime(values[4]);break;case 1:subValues=values[0].split(""),parsedDate.year=subValues[0]+subValues[1]+subValues[2]+subValues[3],parsedDate.month=subValues[5]+subValues[6],parsedDate.dayOfMonth=subValues[8]+subValues[9],parsedDate.time=parseTime(subValues[13]+subValues[14]+subValues[15]+subValues[16]+subValues[17]+subValues[18]+subValues[19]+subValues[20]);break;default:return null}return parsedDate.date=new Date(parsedDate.year,parsedDate.month-1,parsedDate.dayOfMonth),parsedDate.dayOfWeek=String(parsedDate.date.getDay()),parsedDate},date:function(value,format){try{var parsedDate=this.parseDate(value);if(null===parsedDate)return value;for(var year=(parsedDate.date,parsedDate.year),month=parsedDate.month,dayOfMonth=parsedDate.dayOfMonth,dayOfWeek=parsedDate.dayOfWeek,time=parsedDate.time,pattern="",retValue="",unparsedRest="",inQuote=!1,i=0;i<format.length;i++){var currentPattern=format.charAt(i),nextRight=format.charAt(i+1);if(inQuote)"'"==currentPattern?(retValue+=""===pattern?"'":pattern,pattern="",inQuote=!1):pattern+=currentPattern;else switch(pattern+=currentPattern,unparsedRest="",pattern){case"ddd":retValue+=numberToLongDay(dayOfWeek),pattern="";break;case"dd":if("d"===nextRight)break;retValue+=padding(dayOfMonth,2),pattern="";break;case"d":if("d"===nextRight)break;retValue+=parseInt(dayOfMonth,10),pattern="";break;case"D":dayOfMonth=1==dayOfMonth||21==dayOfMonth||31==dayOfMonth?parseInt(dayOfMonth,10)+"st":2==dayOfMonth||22==dayOfMonth?parseInt(dayOfMonth,10)+"nd":3==dayOfMonth||23==dayOfMonth?parseInt(dayOfMonth,10)+"rd":parseInt(dayOfMonth,10)+"th",retValue+=dayOfMonth,pattern="";break;case"MMMM":retValue+=numberToLongMonth(month),pattern="";break;case"MMM":if("M"===nextRight)break;retValue+=numberToShortMonth(month),pattern="";break;case"MM":if("M"===nextRight)break;retValue+=padding(month,2),pattern="";break;case"M":if("M"===nextRight)break;retValue+=parseInt(month,10),pattern="";break;case"y":case"yyy":if("y"===nextRight)break;retValue+=pattern,pattern="";break;case"yy":if("y"===nextRight)break;retValue+=String(year).slice(-2),pattern="";break;case"yyyy":retValue+=year,pattern="";break;case"HH":retValue+=padding(time.hour,2),pattern="";break;case"H":if("H"===nextRight)break;retValue+=parseInt(time.hour,10),pattern="";break;case"hh":hour=0===parseInt(time.hour,10)?12:time.hour<13?time.hour:time.hour-12,retValue+=padding(hour,2),pattern="";break;case"h":if("h"===nextRight)break;hour=0===parseInt(time.hour,10)?12:time.hour<13?time.hour:time.hour-12,retValue+=parseInt(hour,10),pattern="";break;case"mm":retValue+=padding(time.minute,2),pattern="";break;case"m":if("m"===nextRight)break;retValue+=time.minute,pattern="";break;case"ss":retValue+=padding(time.second.substring(0,2),2),pattern="";break;case"s":if("s"===nextRight)break;retValue+=time.second,pattern="";break;case"S":case"SS":if("S"===nextRight)break;retValue+=pattern,pattern="";break;case"SSS":retValue+=time.millis.substring(0,3),pattern="";break;case"a":retValue+=time.hour>=12?"PM":"AM",pattern="";break;case"p":retValue+=time.hour>=12?"p.m.":"a.m.",pattern="";break;case"E":retValue+=numberToShortDay(dayOfWeek),pattern="";break;case"'":pattern="",inQuote=!0;break;default:retValue+=currentPattern,pattern=""}}return retValue+=unparsedRest}catch(e){return console&&console.log&&console.log(e),value}},prettyDate:function(time){var date,diff,day_diff;return("string"==typeof time||"number"==typeof time)&&(date=new Date(time)),"object"==typeof time&&(date=new Date(time.toString())),diff=((new Date).getTime()-date.getTime())/1e3,day_diff=Math.floor(diff/86400),isNaN(day_diff)||0>day_diff?void 0:60>diff?"just now":120>diff?"1 minute ago":3600>diff?Math.floor(diff/60)+" minutes ago":7200>diff?"1 hour ago":86400>diff?Math.floor(diff/3600)+" hours ago":1===day_diff?"Yesterday":7>day_diff?day_diff+" days ago":31>day_diff?Math.ceil(day_diff/7)+" weeks ago":day_diff>=31?"more than 5 weeks ago":void 0},toBrowserTimeZone:function(value,format){return this.date(new Date(value),format||"MM/dd/yyyy HH:mm:ss")}}}()}(DateFormat);var ModuleController={el:null,elpanel:null,arrimg:[],state:{},steps:9,btnPlay:null,btnRefresh:null,btnStepBask:null,btnStepForward:null,moduleName:"ired",errSrc:"",baseURI:"http://www.sat24.com/image2.ashx?region=eu&time=",active:!1,afterUrl:"&ir=true",clip:null,container:null,imgir:null,progressLoader:null,progressBar:null,navTabs:1,offset:15,errLoadI:0,init:function(html,success,elLi){var s=this;s.elLi=elLi,s.el=$(document.createElement("div")).html(html).css({opacity:0}),$(document).find(".content").append(s.el),s.btnPlay=s.el.find(".glyphicon.glyphicon-play"),s.btnRefresh=s.el.find(".glyphicon.glyphicon-refresh"),s.btnStepBask=s.el.find(".glyphicon.glyphicon-step-backward"),s.btnStepForward=s.el.find(".glyphicon.glyphicon-step-forward"),s.progressLoader=s.el.find(".progress-loader"),s.progressBar=s.el.find(".progress-bar"),s.elpanel=s.el.find(".panel-drive"),s.elpanel.on("click",".glyphicon-play",function(){s.active||(s.play(),s.active=!0)}).on("click",".glyphicon-refresh",function(){s.refresh()}).on("click",".glyphicon.glyphicon-step-backward",function(){s.btnStepBask.active||(s.btnStepBask.addClass("active"),s.btnStepBask.active=!0,s.stepBack())}).on("click",".glyphicon.glyphicon-step-forward",function(){s.btnStepForward.active||(s.btnStepForward.addClass("active"),s.btnStepForward.active=!0,s.stepForward())}),s.showImg(),s._init&&s._init(),success&&success.call(s)},showImg:function(errSrc){var s=this,conteiner=s.container=s.el.find(".container-imgs-ir"),mask=app.mask.show(conteiner),date=s.getDate(),src=s.baseURI+date+s.afterUrl,imgir=new Image;s.imgir=imgir,imgir.onerror=function(e){s.errLoadI++,console.error("Error load: "+src,e),s.errLoadI<3&&(s.showImg(s.errSrc),$.ajax({url:"php/saveimgs.php",success:function(img){console.log(img)}}))},imgir.onload=function(){conteiner.append(imgir),$(imgir).fadeTo(500,1,function(){app.mask.remove(mask)})},imgir.src=errSrc||src},load:function(success){function err(e,url){console.log("%c Error load: "+e.type+": "+url,"background: rgba(0,0,0,0.2); color: #FF0000"),ok()}function ok(){if(k++,s.progressBar.css({width:Math.ceil(100*k/steps)+"%"}),k==steps){for(var _arr=[],i=0;steps>i;i++)_arr.push(arr[i]);for(var i=0;steps>i;i++)s.arrimg[steps-i-1]=_arr[i];$(s.imgir).remove();for(var i=0;steps>i;i++)s.container.append(s.arrimg[i]),$(s.arrimg[i]).css({opacity:1});s.clip=steps-1,s.progressLoader.fadeTo(222,0),success&&success.call(s)}}var s=this,arr=s.arrimg,steps=s.steps,k=0,offset=0;s.progressLoader.fadeTo(222,1);for(var i=0;steps>i;i++){offset+=s.offset;var date=s.getStepDate(offset),url=s.baseURI+date+s.afterUrl;arr[i]=new Image,arr[i].onload=ok,arr[i].onerror=function(e){err(e,url)},arr[i].src=url}},play:function(){function start(){k++,k==steps-1&&(k=1,setTimeout(play,500))}function play(){$(arrimg[k]).fadeTo(200,.2,function(){s.clip=k,toFade(k),steps>k&&(k++,play()),k==steps&&(s.active=!1,s.btnPlay.removeClass("active"))})}function toFade(i){$(arrimg[i]).fadeTo(400,1)}var s=this;if(s.btnPlay.addClass("active"),!s.arrimg.length)return void s.load(s.play);for(var steps=s.steps,arrimg=s.arrimg,k=0,i=1;steps>i;i++)$(arrimg[i]).fadeTo(400,0,start)},refresh:function(){var s=this;if(s.arrimg.length)for(var i=0;i<s.arrimg.length;i++)$(s.arrimg[i]).fadeTo(222,0,function(){$(this).remove()});s.imgir&&$(s.imgir).fadeTo(222,0,function(){$(this).remove()}),setTimeout(function(){s.arrimg=[],s.imgir=null,s.showImg()},300)},stepBack:function(){var s=this;return s.arrimg.length?void(s.clip&&0<s.clip?$(s.arrimg[s.clip]).fadeTo(222,0,function(){s.clip--,s.btnStepBask.active=!1,s.btnStepBask.removeClass("active")}):(s.btnStepBask.active=!1,s.btnStepBask.removeClass("active"))):void s.load(s.stepBack)},stepForward:function(){var s=this;return s.arrimg.length?void(s.clip<s.steps-1?(s.clip++,$(s.arrimg[s.clip]).fadeTo(222,1,function(){s.btnStepForward.active=!1,s.btnStepForward.removeClass("active")})):(s.btnStepForward.active=!1,s.btnStepForward.removeClass("active"))):void s.load(s.stepForward)},getDate:function(){var date=mathDate.setParams({mi:15,ss:60})(new Date,{hh:-2,mi:-5});return date=DateFormat.format.date(date,"yyyyMMddHHmm")},getStepDate:function(offset){var date=mathDate.setParams({mi:15,ss:60})(new Date,{hh:-2,mi:-2-offset});return date=DateFormat.format.date(date,"yyyyMMddHHmm")},show:function(html,elLi){var s=this;return s.el?(s.el.css({display:"block"}),void s.el.fadeTo(222,1)):void s.init.call(s,html,s.show,elLi)},hide:function(){var s=this;s.el.fadeTo(222,0,function(){s.el.css({display:"none"})})}};define(function(){return ModuleController});var mathDate={};!function(m){var step={};m.summ=function(_date,_obj,_step){_obj=_obj||{};for(var yyyy,mm,dd,hh,mi,ss,p=["yyyy","mm","dd","hh","mi","ss"],j={},st=_step||step,i=0;i<p.length;i++)j[p[i]]=_obj[p[i]]||0,st[p[i]]=st[p[i]]?st[p[i]]:1;var d=_date||new Date;return yyyy=d.getFullYear(),mm=d.getMonth(),dd=d.getDate(),hh=d.getHours(),mi=d.getMinutes(),ss=d.getSeconds(),d=new Date(yyyy+j.yyyy,mm+j.mm,dd+j.dd,hh+j.hh,mi+j.mi,ss+j.ss),yyyy=Math.floor(d.getFullYear()/st.yyyy)*st.yyyy,mm=Math.floor(d.getMonth()/st.mm)*st.mm,dd=Math.floor(d.getDate()/st.dd)*st.dd,hh=Math.floor(d.getHours()/st.hh)*st.hh,mi=Math.floor(d.getMinutes()/st.mi)*st.mi,ss=Math.floor(d.getSeconds()/st.ss)*st.ss,new Date(yyyy,mm,dd,hh,mi,ss)},m.setParams=function(_step){return step=_step||{},this.summ}}(mathDate);
//# sourceMappingURL=scripts.min.js.map