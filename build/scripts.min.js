function Timer(){this.time=null,this.init=function(){document.getElementById("hh").innerHTML=timer.checkNull((new Date).getHours())+":",document.getElementById("mi").innerHTML=timer.checkNull((new Date).getMinutes())+":",document.getElementById("ss").innerHTML=timer.checkNull((new Date).getSeconds()),setTimeout(function(){timer.init()},500)},this.checkNull=function(a){return 10>a?"0"+a:a}}function Main(){this.img=null,this.nN=null,this.eR=null,this.arrSrc=null,this.count=null,this.time=null,this.tmp=null,this.percent=null,this.blockedPlay=null,this.blockedScan=!1,this.arrImgUkbb=[],this.update=function(){},this.init=function(){var a=this;if(!a.blockedScan){a.blockedScan=!0,$("#buttonScan").removeClass("button").addClass("button-blocked"),a.blockedPlay=!0,$("#buttonPlay").removeClass("button").addClass("button-blocked"),a.tmp="",this.time=((new Date).getTime()+"").split("");for(var b=0;10>b;b++)a.tmp=a.tmp+a.time[b];a.time=parseFloat(a.tmp)-800,a.nN=0,document.getElementById("scan").innerHTML=a.nN,this.img=[],this.nN=0,this.eR=0,this.arrSrc=[],this.percent=0,this.loadImg()}},this.loadImg=function(){var a=this;a.img[a.nN]=new Image,a.img[a.nN].onload=function(){a.arrSrc[a.nN]="http://meteoinfo.by/radar/UKBB/UKBB_"+(a.time+a.eR)+".png",a.arrImgUkbb[a.nN]=new Image,a.arrImgUkbb[a.nN].src=a.arrSrc[a.nN];var b=$(".home .ukbb-content .imgs");b.append($(a.arrImgUkbb[a.nN])),$(a.arrImgUkbb[a.nN]).fadeTo(222,1),a.nN++,document.getElementById("scan").innerHTML=a.nN,a.eR=a.eR-550,a.nN<5?a.loadImg():(a.blockedScan=!1,$("#buttonScan").removeClass("button-blocked").addClass("button"),a.blockedPlay=!1,$("#buttonPlay").removeClass("button-blocked").addClass("button"),document.getElementById("scanProcess").innerHTML="100%",a.initPlay(a.arrSrc.length-1))},a.img[a.nN].onerror=function(){a.percent++,document.getElementById("scanProcess").innerHTML=(a.percent/10+"").split(".")[1]?a.percent/10+"%":a.percent/10+".0%",100<a.percent/10&&0==a.nN?alert("Вероятно радар отключен"):(a.eR--,a.loadImg())},a.img[a.nN].src="http://meteoinfo.by/radar/UKBB/UKBB_"+(a.time+a.eR)+".png"},this.initPlay=function(){function a(c){c>=0?$(b.arrImgUkbb[c]).fadeTo(222,0,function(){setTimeout(function(){a(c-1)},500)}):(b.blockedPlay=!1,$("#buttonPlay").removeClass("button-blocked").addClass("button"))}var b=this;$("#buttonPlay").removeClass("button").addClass("button-blocked");for(var c=b.arrImgUkbb.length,d=0,e=0;c>e;e++)$(b.arrImgUkbb[e]).fadeTo(222,1,function(){d++,d==c&&setTimeout(function(){a(c-1)},1e3)})}}var timer=new Timer,main=new Main,DateFormat={};!function(a){var b=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],c=["Вос","Пон","Втр","Срд","Чет","Пят","Суб"],d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e=["January","February","March","April","May","June","July","August","September","October","November","December"],f={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"},g=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?\d{0,3}[Z\-+]?(\d{2}:?\d{2})?/;a.format=function(){function a(a){return b[parseInt(a,10)]||a}function h(a){return c[parseInt(a,10)]||a}function i(a){var b=parseInt(a,10)-1;return d[b]||a}function j(a){var b=parseInt(a,10)-1;return e[b]||a}function k(a){return f[a]||a}function l(a){var b,c,d,e,f,g=a,h="";return-1!==g.indexOf(".")&&(e=g.split("."),g=e[0],h=e[1]),f=g.split(":"),3===f.length?(b=f[0],c=f[1],d=f[2].replace(/\s.+/,"").replace(/[a-z]/gi,""),g=g.replace(/\s.+/,"").replace(/[a-z]/gi,""),{time:g,hour:b,minute:c,second:d,millis:h}):{time:"",hour:"",minute:"",second:"",millis:""}}function m(a,b){for(var c=b-String(a).length,d=0;c>d;d++)a="0"+a;return a}return{parseDate:function(a){var b={date:null,year:null,month:null,dayOfMonth:null,dayOfWeek:null,time:null};if("number"==typeof a)return this.parseDate(new Date(a));if("function"==typeof a.getFullYear)b.year=String(a.getFullYear()),b.month=String(a.getMonth()+1),b.dayOfMonth=String(a.getDate()),b.time=l(a.toTimeString());else if(-1!=a.search(g))values=a.split(/[T\+-]/),b.year=values[0],b.month=values[1],b.dayOfMonth=values[2],b.time=l(values[3].split(".")[0]);else switch(values=a.split(" "),6===values.length&&isNaN(values[5])&&(values[values.length]="()"),values.length){case 6:b.year=values[5],b.month=k(values[1]),b.dayOfMonth=values[2],b.time=l(values[3]);break;case 2:subValues=values[0].split("-"),b.year=subValues[0],b.month=subValues[1],b.dayOfMonth=subValues[2],b.time=l(values[1]);break;case 7:case 9:case 10:b.year=values[3],b.month=k(values[1]),b.dayOfMonth=values[2],b.time=l(values[4]);break;case 1:subValues=values[0].split(""),b.year=subValues[0]+subValues[1]+subValues[2]+subValues[3],b.month=subValues[5]+subValues[6],b.dayOfMonth=subValues[8]+subValues[9],b.time=l(subValues[13]+subValues[14]+subValues[15]+subValues[16]+subValues[17]+subValues[18]+subValues[19]+subValues[20]);break;default:return null}return b.date=new Date(b.year,b.month-1,b.dayOfMonth),b.dayOfWeek=String(b.date.getDay()),b},date:function(b,c){try{var d=this.parseDate(b);if(null===d)return b;for(var e=(d.date,d.year),f=d.month,g=d.dayOfMonth,k=d.dayOfWeek,l=d.time,n="",o="",p="",q=!1,r=0;r<c.length;r++){var s=c.charAt(r),t=c.charAt(r+1);if(q)"'"==s?(o+=""===n?"'":n,n="",q=!1):n+=s;else switch(n+=s,p="",n){case"ddd":o+=a(k),n="";break;case"dd":if("d"===t)break;o+=m(g,2),n="";break;case"d":if("d"===t)break;o+=parseInt(g,10),n="";break;case"D":g=1==g||21==g||31==g?parseInt(g,10)+"st":2==g||22==g?parseInt(g,10)+"nd":3==g||23==g?parseInt(g,10)+"rd":parseInt(g,10)+"th",o+=g,n="";break;case"MMMM":o+=j(f),n="";break;case"MMM":if("M"===t)break;o+=i(f),n="";break;case"MM":if("M"===t)break;o+=m(f,2),n="";break;case"M":if("M"===t)break;o+=parseInt(f,10),n="";break;case"y":case"yyy":if("y"===t)break;o+=n,n="";break;case"yy":if("y"===t)break;o+=String(e).slice(-2),n="";break;case"yyyy":o+=e,n="";break;case"HH":o+=m(l.hour,2),n="";break;case"H":if("H"===t)break;o+=parseInt(l.hour,10),n="";break;case"hh":hour=0===parseInt(l.hour,10)?12:l.hour<13?l.hour:l.hour-12,o+=m(hour,2),n="";break;case"h":if("h"===t)break;hour=0===parseInt(l.hour,10)?12:l.hour<13?l.hour:l.hour-12,o+=parseInt(hour,10),n="";break;case"mm":o+=m(l.minute,2),n="";break;case"m":if("m"===t)break;o+=l.minute,n="";break;case"ss":o+=m(l.second.substring(0,2),2),n="";break;case"s":if("s"===t)break;o+=l.second,n="";break;case"S":case"SS":if("S"===t)break;o+=n,n="";break;case"SSS":o+=l.millis.substring(0,3),n="";break;case"a":o+=l.hour>=12?"PM":"AM",n="";break;case"p":o+=l.hour>=12?"p.m.":"a.m.",n="";break;case"E":o+=h(k),n="";break;case"'":n="",q=!0;break;default:o+=s,n=""}}return o+=p}catch(u){return console&&console.log&&console.log(u),b}},prettyDate:function(a){var b,c,d;return("string"==typeof a||"number"==typeof a)&&(b=new Date(a)),"object"==typeof a&&(b=new Date(a.toString())),c=((new Date).getTime()-b.getTime())/1e3,d=Math.floor(c/86400),isNaN(d)||0>d?void 0:60>c?"just now":120>c?"1 minute ago":3600>c?Math.floor(c/60)+" minutes ago":7200>c?"1 hour ago":86400>c?Math.floor(c/3600)+" hours ago":1===d?"Yesterday":7>d?d+" days ago":31>d?Math.ceil(d/7)+" weeks ago":d>=31?"more than 5 weeks ago":void 0},toBrowserTimeZone:function(a,b){return this.date(new Date(a),b||"MM/dd/yyyy HH:mm:ss")}}}()}(DateFormat);var ModuleController={el:null,elpanel:null,arrimg:[],state:{},steps:9,btnPlay:null,btnRefresh:null,btnStepBask:null,btnStepForward:null,moduleName:"ired",baseURI:"http://www.sat24.com/image2.ashx?region=eu&time=",active:!1,afterUrl:"&ir=true",clip:null,container:null,imgir:null,progressLoader:null,progressBar:null,navTabs:1,offset:15,init:function(a,b,c){var d=this;d.elLi=c,d.el=$(document.createElement("div")).html(a).css({opacity:0}),$(document).find(".content").append(d.el),d.btnPlay=d.el.find(".glyphicon.glyphicon-play"),d.btnRefresh=d.el.find(".glyphicon.glyphicon-refresh"),d.btnStepBask=d.el.find(".glyphicon.glyphicon-step-backward"),d.btnStepForward=d.el.find(".glyphicon.glyphicon-step-forward"),d.progressLoader=d.el.find(".progress-loader"),d.progressBar=d.el.find(".progress-bar"),d.elpanel=d.el.find(".panel-drive"),d.elpanel.on("click",".glyphicon-play",function(){d.active||(d.play(),d.active=!0)}).on("click",".glyphicon-refresh",function(){d.refresh()}).on("click",".glyphicon.glyphicon-step-backward",function(){d.btnStepBask.active||(d.btnStepBask.addClass("active"),d.btnStepBask.active=!0,d.stepBack())}).on("click",".glyphicon.glyphicon-step-forward",function(){d.btnStepForward.active||(d.btnStepForward.addClass("active"),d.btnStepForward.active=!0,d.stepForward())}),d.showImg(),d._init&&d._init(),b&&b.call(d)},showImg:function(){var a=this,b=a.container=a.el.find(".container-imgs-ir"),c=app.mask.show(b),d=new Image;a.imgir=d,d.onload=function(){b.append(d),$(d).fadeTo(500,1,function(){app.mask.remove(c)})};var e=a.getDate();d.src=a.baseURI+e+a.afterUrl,console.log(d.src)},load:function(a){function b(a,b){console.log("%c Error load: "+a.type+": "+b,"background: rgba(0,0,0,0.2); color: #FF0000"),c()}function c(){if(g++,d.progressBar.css({width:Math.ceil(100*g/f)+"%"}),g==f){for(var b=[],c=0;f>c;c++)b.push(e[c]);for(var c=0;f>c;c++)d.arrimg[f-c-1]=b[c];$(d.imgir).remove();for(var c=0;f>c;c++)d.container.append(d.arrimg[c]),$(d.arrimg[c]).css({opacity:1});d.clip=f-1,d.progressLoader.fadeTo(222,0),a&&a.call(d)}}var d=this,e=d.arrimg,f=d.steps,g=0,h=0;d.progressLoader.fadeTo(222,1);for(var i=0;f>i;i++){h+=d.offset;var j=d.getStepDate(h),k=d.baseURI+j+d.afterUrl;e[i]=new Image,e[i].onload=c,e[i].onerror=function(a){b(a,k)},e[i].src=k}},play:function(){function a(){g++,g==e-1&&(g=1,setTimeout(b,500))}function b(){$(f[g]).fadeTo(200,.2,function(){d.clip=g,c(g),e>g&&(g++,b()),g==e&&(d.active=!1,d.btnPlay.removeClass("active"))})}function c(a){$(f[a]).fadeTo(400,1)}var d=this;if(d.btnPlay.addClass("active"),!d.arrimg.length)return void d.load(d.play);for(var e=d.steps,f=d.arrimg,g=0,h=1;e>h;h++)$(f[h]).fadeTo(400,0,a)},refresh:function(){var a=this;if(a.arrimg.length)for(var b=0;b<a.arrimg.length;b++)$(a.arrimg[b]).fadeTo(222,0,function(){$(this).remove()});a.imgir&&$(a.imgir).fadeTo(222,0,function(){$(this).remove()}),setTimeout(function(){a.arrimg=[],a.imgir=null,a.showImg()},300)},stepBack:function(){var a=this;return a.arrimg.length?void(a.clip&&0<a.clip?$(a.arrimg[a.clip]).fadeTo(222,0,function(){a.clip--,a.btnStepBask.active=!1,a.btnStepBask.removeClass("active")}):(a.btnStepBask.active=!1,a.btnStepBask.removeClass("active"))):void a.load(a.stepBack)},stepForward:function(){var a=this;return a.arrimg.length?void(a.clip<a.steps-1?(a.clip++,$(a.arrimg[a.clip]).fadeTo(222,1,function(){a.btnStepForward.active=!1,a.btnStepForward.removeClass("active")})):(a.btnStepForward.active=!1,a.btnStepForward.removeClass("active"))):void a.load(a.stepForward)},getDate:function(){var a=mathDate.setParams({mi:15,ss:60})(new Date,{hh:-2,mi:-5});return a=DateFormat.format.date(a,"yyyyMMddHHmm")},getStepDate:function(a){var b=mathDate.setParams({mi:15,ss:60})(new Date,{hh:-2,mi:-2-a});return b=DateFormat.format.date(b,"yyyyMMddHHmm")},show:function(a,b){var c=this;return c.el?(c.el.css({display:"block"}),void c.el.fadeTo(222,1)):void c.init.call(c,a,c.show,b)},hide:function(){var a=this;a.el.fadeTo(222,0,function(){a.el.css({display:"none"})})}},mathDate={};!function(a){var b={};a.summ=function(a,c,d){c=c||{};for(var e,f,g,h,i,j,k=["yyyy","mm","dd","hh","mi","ss"],l={},m=d||b,n=0;n<k.length;n++)l[k[n]]=c[k[n]]||0,m[k[n]]=m[k[n]]?m[k[n]]:1;var o=a||new Date;return e=o.getFullYear(),f=o.getMonth(),g=o.getDate(),h=o.getHours(),i=o.getMinutes(),j=o.getSeconds(),o=new Date(e+l.yyyy,f+l.mm,g+l.dd,h+l.hh,i+l.mi,j+l.ss),e=Math.floor(o.getFullYear()/m.yyyy)*m.yyyy,f=Math.floor(o.getMonth()/m.mm)*m.mm,g=Math.floor(o.getDate()/m.dd)*m.dd,h=Math.floor(o.getHours()/m.hh)*m.hh,i=Math.floor(o.getMinutes()/m.mi)*m.mi,j=Math.floor(o.getSeconds()/m.ss)*m.ss,new Date(e,f,g,h,i,j)},a.setParams=function(a){return b=a||{},this.summ}}(mathDate);